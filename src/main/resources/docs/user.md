# Бизнес требования
1. Юзер должен иметь возможность зарегистрироваться и залогиниться.
2. Публиковать фразы, прикреплять к фразе теги.
3. Получать свои фразы.<br/><br/>

# Функциональные требования
## 1.1. Метод registration
**входящие данные**
```json
{
  "authorization": {
    "nickname": "barabashka89",
    "password": "barabashka1980"
  }
}
```
**валидация**<br/>
nickname >= 4 символа, <= 15 символов, разрешенные символы a-zA-Z0-9а-яА-Я. _-<br/>
password >= 8 символов, <= 100 символов, разрешенные символы a-zA-Z0-9а-яА-Я.,:; _?!+=/'\"*(){}[]-

**логика метода**<br/>
сервис совершает поиск в таблице user по столбцу nickname входящий nickname,<br/>
если находит - возвращает ошибку NICKNAME_BUSY,<br/>
иначе генерирует accessToken, шифрует входящий password, записывает в таблицу user nickname, password, accessToken<br/>
возвращает клиенту accessToken

**исходящие данные в случае успеха** <br/>статус 200
```json
{
  "data": {
    "accessToken": "d4a76068f5104f26975499d22bcd11cc1665995491673"
  }
}
```
**исходящие данные в случае ошибки**<br/>статус 400
```json
{
  "error": {
    "code": "REQUEST_VALIDATION_ERROR",
    "userMessage": "Некорректный nickname. Некорректный password"
  }
}
```
```json
{
  "error": {
    "code": "NICKNAME_BUSY",
    "userMessage": "Этот ник уже занят, придумайте другой"
  }
}
```
## 1.2. Метод login
**входящие данные**
```json
{
  "authorization": {
    "nickname": "barabashka89",
    "password": "barabashka1980"
  }
}
```
**валидация**<br/>
nickname >= 4 символа, <= 15 символов, разрешенные символы a-zA-Z0-9а-яА-Я. _-<br/>
password >= 8 символов, <= 100 символов, разрешенные символы a-zA-Z0-9а-яА-Я.,:; _?!+=/'\"*(){}[]-<br/>

**логика метода**<br/>
сервис шифрует password таким же образом что и в _1.1 Метод registration_ и совершает поиск в таблице user по столбцам nickname и password,<br/>
если находит - возвращает accessToken,<br/>
иначе возвращает ошибку USER_NOT_FOUND

**исходящие данные в случае успеха** <br/>статус 200
```json
{
  "data": {
    "accessToken": "d4a76068f5104f26975499d22bcd11cc1665995491673"
  }
}
```
**исходящие данные в случае ошибки**<br/>статус 400
```json
{
  "error": {
    "code": "REQUEST_VALIDATION_ERROR",
    "techMessage": "Некорректный nickname. Некорректный password"
  }
}
```
```json
{
  "error": {
    "code": "USER_NOT_FOUND",
    "userMessage": "Пользователь не найден"
  }
}
```
## 2. Метод publicPhrase (auth)
**входящие данные**<br/>
`AccessToken: 8e043390d24642a9ae64e303568c27d61666011676410`
```json
{
  "text": "Сегодня солнечный день",
  "tags": [
    "погода",
    "солнце",
    "хорошее настроение"
  ]
}
```
**валидация**<br/>
text >= 1 символов, <= 140, разрешенные символы a-zA-Z0-9а-яА-Я.,:; _?!+=/'\"*(){}[]-<br/>
tags от 0 до 5, значение от >= 3 символов, <= 25, разрешенные символы a-zA-Z0-9а-яА-Я.,:; _?!+=/'\"*(){}[]-

**логика метода**<br/>
сервис проверяет наличие accessToken в таблице user столбце access_token,<br/>
если не находит - возвращает ошибку AUTHORIZATION_ERROR,<br/>
иначе получает id юзера по accessToken,<br/>
записывает фразу в таблицу phrase,<br/>
по каждому тегу проверяет есть ли в таблице tag такой тег, если нет - записывает,<br/>
получает id всех тегов,<br/>
записывает id фразы и тегов в таблицу phrase_tag

**исходящие данные в случае успеха** <br/>статус 200

**исходящие данные в случае ошибки**<br/>статус 400
```json
{
  "error": {
    "code": "AUTHORIZATION_ERROR",
    "userMessage": "Ошибка авторизации"
  }
}
```
## 3. Метод getMyPhrases (auth)
**логика метода**<br/>
сервис получает по id юзера его фразы,
по id фраз получает теги к каждой фразе,
упорядочивает фразы по времени от новым к старым и отсылает юзеру

**исходящие данные в случае успеха** <br/>статус 200
```json
{
  "data": {
    "phrases": [
      {
        "id": 9,
        "text": "Сегодня солнечный день - 5",
        "timeInsert": "2022-11-14 16:12:15",
        "tags": [
          "погода",
          "новый тег"
        ]
      },
      {
        "id": 8,
        "text": "Сегодня солнечный день - 4",
        "timeInsert": "2022-11-14 16:09:17",
        "tags": [
          "погода",
          "солнце",
          "хороший день"
        ]
      }
    ]
  }
}
```