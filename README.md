# Бизнес требования
1. Юзер должен иметь возможность зарегистрироваться.
2. Публиковать фразы.
3. Прикреплять к фразе теги.
4. Подписываться на других пользователей.
5. Читать фразы других пользователей.
6. Оценивать фразы других пользователей.
7. Совершать поиск по тегам.
8. Совершать поиск по словам.
9. Совершать поиск по нику.

# Модель данных
**user**<br/>
id, nickname, password, access_token, time_insert

**phrase**<br/>
id, user_id, text, time_insert

**tag**<br/>
id, text, time_insert

**phrase_tag**<br/>
id, phrase_id, tag_id, time_insert

# Функциональные требования
## 1.1. Метод registration
**входящие данные**
```json
{
  "nickname": "barabashka",
  "password": "barabashka1980"
}
```
**валидация**<br/>
nickname >= 4 символа, <= 15 символов, разрешенные символы a-zA-Z0-9а-яА-Я. _-<br/>
password >= 8 символов, <= 100 символов, разрешенные символы a-zA-Z0-9а-яА-Я.,:; _?!+=/'\"*(){}[]-

**логика метода**<br/>
сервис совершает поиск в таблице user по столбцу nickname входящий nickname,<br/>
если находит - возвращает ошибку NICKNAME_BUSY,<br/>
иначе генерирует accessToken, шифрует входящий password, записывает в таблицу user nickname, password, accessToken<br/>
возвращает клиенту accessToken

**исходящие данные в случае успеха** <br/>статус 200
```json
{
  "data": {
    "accessToken": "d4a76068f5104f26975499d22bcd11cc1665995491673"
  }
}
```
**исходящие данные в случае ошибки**<br/>статус 400
```json
{
  "error": {
    "code": "REQUEST_VALIDATION_ERROR",
    "text": "Некорректный nickname. Некорректный password"
  }
}
```
```json
{
  "error": {
    "code": "NICKNAME_BUSY",
    "text": "Этот ник уже занят, придумайте другой"
  }
}
```
## 1.2. Метод login
**входящие данные**
```json
{
  "nickname": "barabashka",
  "password": "barabashka1980"
}
```
**валидация**<br/>
nickname >= 4 символа, <= 15 символов, разрешенные символы a-zA-Z0-9а-яА-Я. _-<br/>
password >= 8 символов, <= 100 символов, разрешенные символы a-zA-Z0-9а-яА-Я.,:; _?!+=/'\"*(){}[]-<br/>

**логика метода**<br/>
сервис шифрует password таким же образом что и в _1.1 Метод registration_ и совершает поиск в таблице user по столбцам nickname и password,<br/>
если находит - возвращает accessToken,<br/>
иначе возвращает ошибку USER_NOT_FOUND

**исходящие данные в случае успеха** <br/>статус 200
```json
{
  "data": {
    "accessToken": "d4a76068f5104f26975499d22bcd11cc1665995491673"
  }
}
```
**исходящие данные в случае ошибки**<br/>статус 400
```json
{
  "error": {
    "code": "REQUEST_VALIDATION_ERROR",
    "text": "Некорректный nickname. Некорректный password"
  }
}
```
```json
{
  "error": {
    "code": "USER_NOT_FOUND",
    "text": "Пользователь не найден"
  }
}
```
## 2. Метод publicPhrase
**входящие данные**<br/>
`AccessToken: 8e043390d24642a9ae64e303568c27d61666011676410`
```json
{
  "text": "Сегодня солнечный день",
  "tags": [
    "погода",
    "солнце",
    "хорошее настроение"
  ]
}
```
**валидация**<br/>
phrase >= 1 символов, <= 140, разрешенные символы a-zA-Z0-9а-яА-Я.,:; _?!+=/'\"*(){}[]-<br/>
tags от 0 до 5, значение от >= 3 символов, <= 25, разрешенные символы a-zA-Z0-9а-яА-Я.,:; _?!+=/'\"*(){}[]-

**логика метода**<br/>
сервис проверяет наличие accessToken в таблице user столбце access_token,<br/>
если не находит - возвращает ошибку AUTHORIZATION_ERROR,<br/>
иначе получает id юзера по accessToken,<br/>
записывает фразу в таблицу phrase,<br/>
по каждому тегу проверяет есть ли в таблице tag такой тег, если нет - записывает,<br/>
получает id всех тегов,<br/>
записывает id фразы и тегов в таблицу phrase_tag

**исходящие данные в случае успеха** <br/>статус 200

**исходящие данные в случае ошибки**<br/>статус 400
```json
{
  "error": {
    "code": "AUTHORIZATION_ERROR",
    "text": "Ошибка авторизации"
  }
}
```